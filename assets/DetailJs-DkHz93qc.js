import{R as y}from"./reception-DQKtJk0Z.js";const L=(e,c)=>{const n=e.querySelectorAll(".mockup_img"),o=new Set,r=10;n.forEach((a,d)=>{let u;if(d===0){a.src=c;const l=parseInt(c.split("/").pop().split(".")[0]);o.add(l)}else{do u=h(1,r);while(o.has(u));o.add(u),a.src=`./assets/images/Recommend/${u}.jpg`}a.onclick=()=>{P(d),v(d)}}),v(0)},P=e=>{const c=document.querySelector(".mockup_img"),n=document.querySelectorAll(".td_box .mockup_img");c.src=n[e].src},v=e=>{document.querySelectorAll(".td_box .mockup_img").forEach((n,o)=>{o===e?n.classList.add("highlighted"):n.classList.remove("highlighted")})};document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".addcart");e&&e.addEventListener("click",A);const c=document.querySelector(".collection"),n=document.getElementById("messageContainer");(e||c)&&(e.addEventListener("click",function(t){t.preventDefault(),N(n,"已添加购物车")}),c.addEventListener("click",function(t){t.preventDefault(),N(n,"已收藏")}));const o=y.getProductData();if(!o){console.error("No product data found.");return}const r=document.querySelector(".mockup_img");r&&(r.src="./"+o.image);const a=document.querySelector(".head_span");a&&(a.textContent=o.text);const d=document.querySelector(".tr_two.Price");d&&(d.textContent=o.price);const u=document.querySelector(".tr_two.fire");u&&T(u,5);const l=document.querySelector(".tr_there");if(l){const t=h(100,1e3);l.textContent=`${t} 件可售`,l.dataset.maxStock=t}const S=document.querySelector(".td_box");S&&L(S,r.src);const s=document.querySelector(".i_txt"),I=o.defaultQuantity||1;s.value=I,s&&s.addEventListener("input",function(){const t=s.value.trim(),i=parseInt(l.dataset.maxStock);isNaN(t)||t<=0||t>i?s.value=1:p(s.value)});const q=document.querySelector(".decrement"),k=document.querySelector(".increment");q&&k&&(q.addEventListener("click",function(){const t=parseInt(s.value);t>1&&(s.value=t-1,p(s.value))}),k.addEventListener("click",function(){const t=parseInt(s.value),i=parseInt(l.dataset.maxStock);t<i&&(s.value=t+1,p(s.value))}));const x=document.querySelector(".left_button"),_=document.querySelector(".right_button");let m=0;x&&_&&(x.addEventListener("click",()=>E(-1)),_.addEventListener("click",()=>E(1)));const f=document.querySelector(".there input");f&&(f.value=b(C(I,o.price)));function E(t){const i=document.querySelectorAll(".td_box .mockup_img"),g=i.length;m=(m+t+g)%g;const D=document.querySelector(".mockup_img");D.src=i[m].src,v(m)}function p(t){const i=C(t,o.price);f&&(f.value=b(i))}function C(t,i){const g=parseFloat(i.replace("¥",""));return t*g}function b(t){return`¥ ${t.toFixed(2)}`}});const T=(e,c)=>{const n="./assets/images/Detail/fire-icon.png",o=e.querySelectorAll("span");for(let r=0;r<c;r++){const a=document.createElement("img");a.src=n,a.alt="Fire Icon",e.insertBefore(a,e.firstChild),r<c-1&&e.insertBefore(document.createTextNode(" "),e.firstChild)}for(let r=0;r<o.length;r++){const a=h(100,1e3);o[r].textContent=`${a}`}},h=(e,c)=>Math.floor(Math.random()*(c-e+1))+e;function A(e){e.preventDefault();const c=y.getProductData();if(!c){console.error("No product data found.");return}const n=document.querySelector(".i_txt"),o=parseInt(n.value,10);if(isNaN(o)||o<=0){console.error("Invalid quantity.");return}const r={...c,quantity:o};y.storePromotionData(r)}function N(e,c){const n=document.createElement("div");n.className="message",n.textContent=c;const o=Array.from(e.querySelectorAll(".message"));e.appendChild(n),o.forEach((r,a)=>{setTimeout(()=>{r.style.bottom=`${90+(o.length-a)*85}px`,console.log("msg.style.bottom="+r.style.bottom)},10)}),n.style.bottom="10%",setTimeout(function(){n.style.opacity="0",setTimeout(function(){n.parentNode===e?(e.removeChild(n),console.log("消息已移除")):console.error("消息元素已经不在原来的容器中")},500)},3e3)}
